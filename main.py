import telebot
import config
import requests
from bs4 import BeautifulSoup as BS
import re

from telebot import types

bot = telebot.TeleBot(config.TOKEN)

def crypto_price(name):
	rs = requests.get('https://alpari.com/ru/markets/crypto/' + name + '/')
	html = BS(rs.content, 'html.parser')
	title = html.select('.analytics-crypto-item__instrument-price-left')

	return title
	

def stat_24hour(name):
	rs = requests.get('https://alpari.com/ru/markets/crypto/' + name + '/')
	html = BS(rs.content, 'html.parser')
	title = html.select('.analytics-crypto-item__instrument-price-right')
	title = str(title)
	title = title.replace('[<div class="analytics-crypto-item__instrument-price-right">','')
	title = title.replace('</div><div>2.67%</div></div>]','')
	title = title.replace('<div>','')
	return title[0]

	


@bot.message_handler(commands=['start'])
def welcome(message):
	markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
	item1 = types.KeyboardButton('üíµ–ö—É—Ä—Å—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç')
	item2 = types.KeyboardButton('üìä–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 24 —á–∞—Å–∞')

	markup.add(item1,item2)
	gg = '–ü—Ä–∏–≤–µ—Ç, <b>' + message.from_user.first_name.title() + '</b>!\n –Ø - PhloIT, –Ω–æ —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–∑—ã–≤–∞—Ç—å –º–µ–Ω—è –ª—É—á—à–∏–º —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–æ–º  –≤ –º–∏—Ä–µ –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Çüòè\n\n–ù—É —á—Ç–æ,–Ω–∞—á–Ω—ë–º?!üòÉ'.format(message.from_user, bot.get_me()) 
	bot.send_message(message.chat.id, gg ,parse_mode='html',reply_markup=markup)


@bot.message_handler(content_types=['text'])
def crypto_price_telegram(message):
	if message.chat.type == 'private':
		if message.text == 'üíµ–ö—É—Ä—Å—ã –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç':
			markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
			item1 = types.KeyboardButton('Bitcoin')
			item2 = types.KeyboardButton('Ethereum')
			item3 = types.KeyboardButton('XRP')
			item4 = types.KeyboardButton('Monero')
			item5 = types.KeyboardButton('Bitcoin Cash')
			item6 = types.KeyboardButton('Dash')
			item7 = types.KeyboardButton('Litecoin')
			item8 = types.KeyboardButton('EOS')
			item9 = types.KeyboardButton('–ù–∞–∑–∞–¥')
			markup.add(item1,item2,item3,item4,item5,item6,item7,item8,item9)

			bot.send_message(message.chat.id, '–¢—ã–∫–∞–π –Ω–∞ –ª—é–±—É—é –∫—Ä–∏–ø—Ç—É –≤–Ω–∏–∑—É –∏ –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —É–∑–Ω–∞–≤–∞–π –µ—ë –∫—É—Ä—Å' ,parse_mode='html',reply_markup=markup)

		if message.text == 'Bitcoin':
			bot.send_message(message.chat.id, crypto_price('bitcoin'))
		elif message.text == 'Ethereum':
			bot.send_message(message.chat.id, crypto_price('ethereum'))
		elif message.text == 'XRP':
			bot.send_message(message.chat.id, crypto_price('xrp'))
		elif message.text == 'Monero':
			bot.send_message(message.chat.id, crypto_price('monero'))
		elif message.text == 'Bitcoin Cash':
			bot.send_message(message.chat.id, crypto_price('bitcoin_cash'))
		elif message.text == 'Dash':
			bot.send_message(message.chat.id, crypto_price('dash'))
		elif message.text == 'Litecoin':
			bot.send_message(message.chat.id, crypto_price('litecoin'))
		elif message.text == 'EOS':
			bot.send_message(message.chat.id, crypto_price('eos'))
		elif message.text == '–ù–∞–∑–∞–¥':
			bot.send_message(message.chat.id, welcome(message))


		if message.text == 'üìä–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ 24 —á–∞—Å–∞':

			markup = types.ReplyKeyboardMarkup(resize_keyboard=True)
			item1 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ Bitcoin')
			item2 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ Ethereum')
			item3 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ XRP')
			item4 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ Monero')
			item5 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ Bitcoin Cash')
			item6 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ Dash')
			item7 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ Litecoin')
			item8 = types.KeyboardButton('–î–∏–Ω–∞–º–∏–∫–∞ EOS')
			item9 = types.KeyboardButton('–ù–∞–∑–∞–¥')
			markup.add(item1,item2,item3,item4,item5,item6,item7,item8,item9)

			bot.send_message(message.chat.id, '–¢—ã–∫–∞–π –Ω–∞ –ª—é–±—É—é –∫—Ä–∏–ø—Ç—É –≤–Ω–∏–∑—É –∏ –º–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ —É–∑–Ω–∞–π –¥–∏–Ω–∞–º–∏–∫—É –∫—É—Ä—Å–∞' ,parse_mode='html',reply_markup=markup)


		if message.text == '–î–∏–Ω–∞–º–∏–∫–∞ Bitcoin':
			gg = stat_24hour('bitcoin')
			if gg == '-' :
				bot.send_message(message.chat.id, '–ë–∏—Ç–æ–∫ –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else :
				bot.send_message(message.chat.id, '–ë–∏—Ç–æ–∫ –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ Ethereum':
			gg = stat_24hour('ethereum')
			if gg == '-' :
				bot.send_message(message.chat.id, '–≠—Ñ–∏—Ä –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else :
				bot.send_message(message.chat.id, '–≠—Ñ–∏—Ä –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ XRP':
			gg = stat_24hour('xrp')
			if gg == '-' :
				bot.send_message(message.chat.id, 'XRP –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else :
				bot.send_message(message.chat.id, 'XRP –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ Monero':
			gg = stat_24hour('monero')
			if gg == '-' :
				bot.send_message(message.chat.id, 'Monero –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else:
				bot.send_message(message.chat.id, 'Monero –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ Bitcoin Cash':
			gg = stat_24hour('bitcoin_cash')
			if gg == '-' :
				bot.send_message(message.chat.id, 'Bitcoin Cash –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else:
				bot.send_message(message.chat.id, 'Bitcoin Cash –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ Dash':
			gg = stat_24hour('dash')
			if gg == '-' :
				bot.send_message(message.chat.id, 'Dash –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else:
				bot.send_message(message.chat.id, 'Dash –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ Litecoin':
			gg = stat_24hour('litecoin')
			if gg == '-' :
				bot.send_message(message.chat.id, 'Litecoin –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else:
				bot.send_message(message.chat.id, 'Litecoin –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–î–∏–Ω–∞–º–∏–∫–∞ EOS':
			gg = stat_24hour('eos')
			if gg == '-' :
				bot.send_message(message.chat.id, 'EOS –ø–æ–¥—Å–µ–ª –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üò≠‚¨áÔ∏è')
			else:
				bot.send_message(message.chat.id, 'EOS –ø–æ–¥–Ω—è–ª—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞üòÉüÜô')
		elif message.text == '–ù–∞–∑–∞–¥':
			bot.send_message(message.chat.id, welcome(message))
		



bot.polling(none_stop=True)